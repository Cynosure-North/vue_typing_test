(function(y,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(y=typeof globalThis<"u"?globalThis:y||self,e(y.TestComponent={},y.Vue))})(this,function(y,e){"use strict";const v={__name:"Letter",props:{char:String,color:String},setup(r){return(o,a)=>(e.openBlock(),e.createElementBlock("div",{style:e.normalizeStyle({color:r.color})},e.toDisplayString(r.char),5))}},W=".caret[data-v-86a5189b]{position:absolute;width:.1em;height:1lh;border-radius:.05em;background-color:#000;transition:left .08s;animation-name:blink-86a5189b;animation-duration:.8s;animation-iteration-count:infinite;animation-timing-function:steps(2,jump-both)}@keyframes blink-86a5189b{0%{opacity:.9}to{opacity:.2}}",_=(r,o)=>{const a=r.__vccOpts||r;for(const[n,i]of o)a[n]=i;return a},S=_({__name:"Caret",props:{offset:Number},setup(r){return(o,a)=>(e.openBlock(),e.createElementBlock("div",{className:"caret",style:e.normalizeStyle({left:r.offset+"ch"})},null,4))}},[["styles",[W]],["__scopeId","data-v-86a5189b"]]),T=_(e.defineComponent({__name:"Word",props:{word:{type:String,required:!0},typedWord:{type:String,required:!0},wordStatus:{type:String,required:!0}},setup(r){e.useCssVars(s=>({e6436472:i.value}));const o=r,a=e.useTemplateRef("ref"),n=e.computed(()=>o.typedWord.slice(o.word.length)),i=e.computed(()=>o.wordStatus==="incorrect"?t("incorrect")+" solid 0.1lh":"transparent solid 0.1lh"),f=(s,l)=>o.typedWord.charAt(l)===s?"correct":o.typedWord.charAt(l)!=""?"incorrect":o.wordStatus==="active"?"active":"passive",t=s=>{switch(s){case"passive":return"#ccc";case"active":return"#777";case"correct":return"#000";case"incorrect":return"red"}};return e.onUpdated(async()=>{o.wordStatus==="active"&&(await e.nextTick(),a.value?.scrollIntoView({behavior:"smooth",block:"center"}))}),(s,l)=>(e.openBlock(),e.createElementBlock("div",{class:"word",ref_key:"ref",ref:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.word,(u,d)=>(e.openBlock(),e.createBlock(v,{key:d,char:u,color:t(f(u,d))},null,8,["char","color"]))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,(u,d)=>(e.openBlock(),e.createBlock(v,{key:"s"+d,char:u,color:t("incorrect")},null,8,["char","color"]))),128)),r.wordStatus==="active"?(e.openBlock(),e.createBlock(S,{key:0,offset:r.typedWord?.length||0},null,8,["offset"])):e.createCommentVNode("",!0)],512))}}),[["styles",[".word[data-v-595f7012]{display:flex;margin:.15lh .2em;position:relative;border-bottom:var(--e6436472)}"]],["__scopeId","data-v-595f7012"]]),L={class:"wordSet"},E=_(e.defineComponent({__name:"WordSet",props:{wordList:{type:Array,required:!0},typedWordList:{type:Array,required:!0},activeWordIndex:{type:Number,required:!0}},setup(r){const o=r,a=(n,i)=>o.activeWordIndex===i?"active":o.activeWordIndex>i?o.typedWordList[i]!==n?"incorrect":"correct":"passive";return(n,i)=>(e.openBlock(),e.createElementBlock("div",L,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.wordList,(f,t)=>(e.openBlock(),e.createBlock(T,{key:f+t,word:f,typedWord:r.typedWordList[t]||"",wordStatus:a(f,t)},null,8,["word","typedWord","wordStatus"]))),128))]))}}),[["styles",[".wordSet[data-v-0c65b6ed]{display:flex;flex-wrap:wrap;overflow:hidden;-webkit-user-select:none;user-select:none}"]],["__scopeId","data-v-0c65b6ed"]]),w=_(e.defineComponent({__name:"TypingTest",props:{text:{type:Array,required:!0}},emits:["results_ready"],setup(r,{expose:o,emit:a}){const n=r,i=a,f=e.useTemplateRef("typingTest"),t=e.ref([""]),s=e.ref(0),l=e.ref({}),u=e.ref(0),d=e.ref(-1),m=e.ref([]),C=c=>{if(n.text===null||d.value===-2)return;c.preventDefault();const p=t.value[t.value.length-1]||"";if(c.key===" "){t.value.length!==n.text.length&&(n.text[s.value]?.length!==p?.length&&(u.value=u.value+((n.text[s.value]?.length||0)-p.length)),t.value=[...t.value,""],s.value++,m.value=[...m.value,{key:"Space",time:Date.now()}]);return}if(c.key==="Backspace"){if(c.ctrlKey)s.value!==0?p?.length===0?(t.value=[...t.value.slice(0,-2),""],s.value--):t.value=[...t.value.slice(0,-1),""]:t.value=[""];else if(p?.length===0)s.value!==0&&(t.value=t.value.slice(0,-1),s.value--);else{let h=t.value.slice(0,-1);h.push(p?.slice(0,-1)||""),t.value=h}m.value=[...m.value,{key:"Backspace",time:Date.now()}];return}if(c.key.match(/^[-a-zA-Z0-9!@#$%^&*()_+=[\]{};':",./<>?\\|`~]$/)){d.value===-1&&(d.value=Date.now());const h=n.text[s.value]?.charAt(p?.length||0);c.key!==h&&u.value++;let x=t.value.slice(0,-1);if(x.push(p+c.key),t.value=x,m.value=[...m.value,{key:c.key,time:Date.now()}],t.value.length===n.text.length&&(p?.length||0)===(n.text[s.value]?.length||0)-1){const b=(Date.now()-d.value)/1e3;d.value=-2;const B=n.text.flatMap((g,k)=>g.split("").map((A,D)=>t.value[k]?.charAt(D)!==A?1:0)).reduce((g,k)=>g+k,0),I=u.value-B,q=n.text.length/(b/60);l.value={time_taken:b,uncorrected_errors:B,corrected_errors:I,wpm:q,text_length:n.text.join("").length+(n.text.length-1),keystroke_log:m.value},i("results_ready",{results:l.value}),console.log(l.value)}}};return o({getResults:async()=>{if(l.value)return l.value;for(;;)if(await new Promise(c=>setTimeout(c,1e4)),l.value)return l}}),e.onMounted(()=>{f.value?.focus()}),(c,p)=>(e.openBlock(),e.createElementBlock("div",{class:"test",ref_key:"typingTest",ref:f,tabindex:"0",onKeydown:C},[e.createVNode(E,{wordList:r.text,typedWordList:t.value,activeWordIndex:s.value},null,8,["wordList","typedWordList","activeWordIndex"])],544))}}),[["styles",[".test[data-v-bd556bed]{margin:0 auto;height:4.2lh;overflow:hidden;outline:none;transition:color .5s ease;font-family:monospace;font-size:24px}.test[data-v-bd556bed]:focus-within{filter:none}"]],["__scopeId","data-v-bd556bed"]]),$=defineCustomElement(w);customElements.define("TypingTest",$),y.TypingTest=w,Object.defineProperty(y,Symbol.toStringTag,{value:"Module"})});
