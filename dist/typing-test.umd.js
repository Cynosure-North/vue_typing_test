(function(e,m){typeof exports=="object"&&typeof module<"u"?m(require("vue")):typeof define=="function"&&define.amd?define(["vue"],m):(e=typeof globalThis<"u"?globalThis:e||self,m(e.Vue))})(this,function(e){"use strict";const m={__name:"Letter",props:{char:String,color:String},setup(n){return(o,l)=>(e.openBlock(),e.createElementBlock("div",{style:e.normalizeStyle({color:n.color})},e.toDisplayString(n.char),5))}},B=".caret[data-v-86a5189b]{position:absolute;width:.1em;height:1lh;border-radius:.05em;background-color:#000;transition:left .08s;animation-name:blink-86a5189b;animation-duration:.8s;animation-iteration-count:infinite;animation-timing-function:steps(2,jump-both)}@keyframes blink-86a5189b{0%{opacity:.9}to{opacity:.2}}",h=(n,o)=>{const l=n.__vccOpts||n;for(const[p,i]of o)l[p]=i;return l},W=h({__name:"Caret",props:{offset:Number},setup(n){return(o,l)=>(e.openBlock(),e.createElementBlock("div",{className:"caret",style:e.normalizeStyle({left:n.offset+"ch"})},null,4))}},[["styles",[B]],["__scopeId","data-v-86a5189b"]]),S=h(e.defineComponent({__name:"Word",props:{word:{type:String,required:!0},typedWord:{type:String,required:!0},wordStatus:{type:String,required:!0}},setup(n){e.useCssVars(t=>({e6436472:i.value}));const o=n,l=e.useTemplateRef("ref"),p=e.computed(()=>o.typedWord.slice(o.word.length)),i=e.computed(()=>o.wordStatus==="incorrect"?r("incorrect")+" solid 0.1lh":"transparent solid 0.1lh"),f=(t,s)=>o.typedWord.charAt(s)===t?"correct":o.typedWord.charAt(s)!=""?"incorrect":o.wordStatus==="active"?"active":"passive",r=t=>{switch(t){case"passive":return"#ccc";case"active":return"#777";case"correct":return"#000";case"incorrect":return"red"}};return e.onUpdated(async()=>{o.wordStatus==="active"&&(await e.nextTick(),l.value?.scrollIntoView({behavior:"smooth",block:"center"}))}),(t,s)=>(e.openBlock(),e.createElementBlock("div",{class:"word",ref_key:"ref",ref:l},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.word,(a,d)=>(e.openBlock(),e.createBlock(m,{key:d,char:a,color:r(f(a,d))},null,8,["char","color"]))),128)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,(a,d)=>(e.openBlock(),e.createBlock(m,{key:"s"+d,char:a,color:r("incorrect")},null,8,["char","color"]))),128)),n.wordStatus==="active"?(e.openBlock(),e.createBlock(W,{key:0,offset:n.typedWord?.length||0},null,8,["offset"])):e.createCommentVNode("",!0)],512))}}),[["styles",[".word[data-v-595f7012]{display:flex;margin:.15lh .2em;position:relative;border-bottom:var(--e6436472)}"]],["__scopeId","data-v-595f7012"]]),T={class:"wordSet"},L=h(e.defineComponent({__name:"WordSet",props:{wordList:{type:Array,required:!0},typedWordList:{type:Array,required:!0},activeWordIndex:{type:Number,required:!0}},setup(n){const o=n,l=(p,i)=>o.activeWordIndex===i?"active":o.activeWordIndex>i?o.typedWordList[i]!==p?"incorrect":"correct":"passive";return(p,i)=>(e.openBlock(),e.createElementBlock("div",T,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.wordList,(f,r)=>(e.openBlock(),e.createBlock(S,{key:f+r,word:f,typedWord:n.typedWordList[r]||"",wordStatus:l(f,r)},null,8,["word","typedWord","wordStatus"]))),128))]))}}),[["styles",[".wordSet[data-v-0c65b6ed]{display:flex;flex-wrap:wrap;overflow:hidden;-webkit-user-select:none;user-select:none}"]],["__scopeId","data-v-0c65b6ed"]]),E=h(e.defineComponent({__name:"TypingTest",props:{text:{type:String,required:!0}},emits:["results_ready"],setup(n,{expose:o,emit:l}){const p=n,i=l,f=e.useTemplateRef("typingTest"),r=p.text.split(" "),t=e.ref([""]),s=e.ref(0),a=e.ref({}),d=e.ref(0),_=e.ref(-1),y=e.ref([]),C=c=>{if(_.value===-2)return;c.preventDefault();const u=t.value[t.value.length-1]||"";if(c.key===" "){t.value.length!==r.length&&(r[s.value]?.length!==u?.length&&(d.value=d.value+((r[s.value]?.length||0)-u.length)),t.value=[...t.value,""],s.value++,y.value=[...y.value,{key:"Space",time:Date.now()}]);return}if(c.key==="Backspace"){if(c.ctrlKey)s.value!==0?u?.length===0?(t.value=[...t.value.slice(0,-2),""],s.value--):t.value=[...t.value.slice(0,-1),""]:t.value=[""];else if(u?.length===0)s.value!==0&&(t.value=t.value.slice(0,-1),s.value--);else{let k=t.value.slice(0,-1);k.push(u?.slice(0,-1)||""),t.value=k}y.value=[...y.value,{key:"Backspace",time:Date.now()}];return}if(c.key.match(/^[-a-zA-Z0-9!@#$%^&*()_+=[\]{};':",./<>?\\|`~]$/)){_.value===-1&&(_.value=Date.now());const k=r[s.value]?.charAt(u?.length||0);c.key!==k&&d.value++;let w=t.value.slice(0,-1);if(w.push(u+c.key),t.value=w,y.value=[...y.value,{key:c.key,time:Date.now()}],t.value.length===r.length&&(u?.length||0)===(r[s.value]?.length||0)-1){const b=(Date.now()-_.value)/1e3;_.value=-2;const x=r.flatMap((g,v)=>g.split("").map((A,D)=>t.value[v]?.charAt(D)!==A?1:0)).reduce((g,v)=>g+v,0),I=d.value-x,q=r.length/(b/60);a.value={time_taken:b,uncorrected_errors:x,corrected_errors:I,wpm:q,text_length:r.join("").length+(r.length-1),keystroke_log:y.value},i("results_ready",{results:a.value}),console.log(a.value)}}};return o({getResults:async()=>{if(a.value)return a.value;for(;;)if(await new Promise(c=>setTimeout(c,1e4)),a.value)return a}}),e.onMounted(()=>{f.value?.focus()}),(c,u)=>(e.openBlock(),e.createElementBlock("div",{class:"test",ref_key:"typingTest",ref:f,tabindex:"0",onKeydown:C},[e.createVNode(L,{wordList:e.unref(r),typedWordList:t.value,activeWordIndex:s.value},null,8,["wordList","typedWordList","activeWordIndex"])],544))}}),[["styles",[".test[data-v-a7b349b2]{margin:0 auto;height:4.2lh;overflow:hidden;outline:none;transition:color .5s ease;font-family:monospace;font-size:24px}.test[data-v-a7b349b2]:focus-within{filter:none}"]],["__scopeId","data-v-a7b349b2"]]),$=e.defineCustomElement(E);customElements.define("typing-test",$)});
